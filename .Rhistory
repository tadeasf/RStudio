library(readxl)
data <- read_excel("C:/Users/Tadeáš/Desktop/ukol menzy/menzy_pruzkum.xlsx"")
data <- read_excel("C:/Users/Tadeáš/Desktop/ukol menzy/menzy_pruzkum.xlsx"")
data <- read_excel("C:/Users/Tadeáš/Desktop/ukol menzy/menzy_pruzkum.xlsx")
library(tidyverse)
tidy <- data %>% gather(typ_menza_den, známka, -c(osobaID, pohlavi), na.rm = TRUE) %>%
separate(typ_menza_den, c("typ", "menza", "den"), sep = "_")
tidy$den <- factor(tidy$den, ordered = TRUE, levels = c("po", "út", "st", "čt", "pá"))
tidy
tidy %>% summarise(pocet = n_distinct(osobaID))
tidy %>% group_by(pohlavi) %>% summarise(počet = n_distinct(osobaID))
tidy %>% group_by(den, pohlavi) %>% summarise(pocet = n_distinct(osobaID))
tidy %>% group_by(den, pohlavi) %>% summarise(pocet = n_distinct(osobaID))
library(readxl)
data <- read_excel("C:/Users/Tadeáš/Desktop/ukol menzy/menzy_pruzkum.xlsx")
library(tidyverse)
tidy <- data %>% gather(typ_menza_den, známka, -c(osobaID, pohlavi), na.rm = TRUE) %>%
separate(typ_menza_den, c("typ", "menza", "den"), sep = "_")
tidy$den <- factor(tidy$den, ordered = TRUE, levels = c("po", "út", "st", "čt", "pá"))
tidy
tidy %>% summarise(pocet = n_distinct(osobaID))
tidy %>% group_by(pohlavi) %>% summarise(počet = n_distinct(osobaID))
tidy %>% group_by(den, pohlavi) %>% summarise(pocet = n_distinct(osobaID))
remotes::install_github("jmcphers/rsrecovr")
remotes(install_github("jmcphers/rsrecovr"))
install.packages("remotes")
packages(remotes)
library(remotes)
remotes::install_github("jmcphers/rsrecovr")
library(rsrecovr)
library("quanteda")
library("readtext")
library("stopwords")
library("SnowballC")
library("wordcloud")
library("RColorBrewer")
library("quanteda.textplots")
library("quanteda.textstats")
library("ggplot2")
KonecSvěta <- readtext("C:/Users/Tadeáš/Desktop/ukol menzy/data murakami/Murakami.txt")
KonecSvěta <- readtext("~/GitHub/RStudio/data murakami/Murakami.txt")
KorpusWonderland <- corpus(KonecSveta)
summary(KorpusWonderland)
as.character(KorpusWonderland)[2]
summary(KorpusWonderland, n = 1)
Tokeny <- tokens(KorpusWonderland, remove_numbers = TRUE, remove_punct = TRUE, remove_symbols = TRUE, remove_url = TRUE, remove_separators = TRUE)
MaleTokeny <- tokens_tolower(Tokeny, keep_acronyms = FALSE)
CisteTokeny <- tokens_select(MaleTokeny, pattern = stopwords(language = "en", source = "snowball", simplify = TRUE), selection = "remove")
print(CisteTokeny)
ManualniNiceni <- tokens_select(CisteTokeny, pattern = c("said", "like", "one", "say", "can", "go", "right"), selection = "remove")
MatrixWonderland <- tokens(ManualniNiceni) %>%
dfm()
MatrixWonderland[, 1:30]
MatrixWonderland <- dfm_wordstem(MatrixWonderland)
topfeatures(MatrixWonderland, 20)
set.seed(100)
textplot_wordcloud(MatrixWonderland, min_count = 100, random_order = FALSE, rotation = 0.25, color = RColorBrewer::brewer.pal(9, "YlGnBu"))
topfeatures(MatrixWonderland, 50)
topfeatures(MatrixWonderland, 70)
topfeatures(MatrixWonderland, 80)
library("quanteda")
library("readtext")
library("stopwords")
library("SnowballC")
library("wordcloud")
library("RColorBrewer")
library("quanteda.textplots")
library("quanteda.textstats")
library("ggplot2")
KonecSvěta <- readtext("~/GitHub/RStudio/data murakami/Murakami.txt")
KonecSvěta <- readtext("~/GitHub/RStudio/data murakami/Murakami.txt")
KorpusWonderland <- corpus(KonecSveta)
summary(KorpusWonderland)
as.character(KorpusWonderland)[2]
summary(KorpusWonderland, n = 1)
tokens(KorpusWonderland, remove_numbers = TRUE, remove_punct = TRUE, remove_symbols = TRUE, remove_url = TRUE, remove_separators = TRUE)
Tokeny <- tokens(KorpusWonderland, remove_numbers = TRUE, remove_punct = TRUE, remove_symbols = TRUE, remove_url = TRUE, remove_separators = TRUE)
MaleTokeny <- tokens_tolower(Tokeny, keep_acronyms = FALSE)
CisteTokeny <- tokens_select(MaleTokeny, pattern = stopwords(language = "en", source = "snowball", simplify = TRUE), selection = "remove")
print(CisteTokeny)
ManualniNiceni <- tokens_select(CisteTokeny, pattern = c("said", "like", "one", "say", "can", "go", "right"), selection = "remove")
MatrixWonderland <- tokens(ManualniNiceni) %>%
dfm()
MatrixWonderland[, 1:30]
MatrixWonderland <- dfm_wordstem(MatrixWonderland)
topfeatures(MatrixWonderland, 80)
library("quanteda")
library("readtext")
library("stopwords")
library("SnowballC")
library("wordcloud")
library("RColorBrewer")
library("quanteda.textplots")
library("quanteda.textstats")
library("ggplot2")
KonecSvěta <- readtext("~/GitHub/RStudio/data murakami/Murakami.txt")
KorpusWonderland <- corpus(KonecSveta)
summary(KorpusWonderland)
as.character(KorpusWonderland)[2]
summary(KorpusWonderland, n = 1)
tokens(KorpusWonderland, remove_numbers = TRUE, remove_punct = TRUE, remove_symbols = TRUE, remove_url = TRUE, remove_separators = TRUE)
Tokeny <- tokens(KorpusWonderland, remove_numbers = TRUE, remove_punct = TRUE, remove_symbols = TRUE, remove_url = TRUE, remove_separators = TRUE)
MaleTokeny <- tokens_tolower(Tokeny, keep_acronyms = FALSE)
CisteTokeny <- tokens_select(MaleTokeny, pattern = stopwords(language = "en", source = "snowball", simplify = TRUE), selection = "remove")
print(CisteTokeny)
ManualniNiceni <- tokens_select(CisteTokeny, pattern = c("said", "like", "one", "say", "can", "go", "right"), selection = "remove")
MatrixWonderland <- tokens(ManualniNiceni) %>%
dfm()
MatrixWonderland[, 1:30]
topfeatures(MatrixWonderland, 80)
MatrixWonderland <- dfm_wordstem(MatrixWonderland, lagunage = quanteda_options("language_stemmer"))
MatrixWonderland <- dfm_wordstem(MatrixWonderland, language = quanteda_options("language_stemmer"))
topfeatures(MatrixWonderland, 80)
library("quanteda")
library("readtext")
library("stopwords")
library("SnowballC")
library("wordcloud")
library("RColorBrewer")
library("quanteda.textplots")
library("quanteda.textstats")
library("ggplot2")
KonecSvěta <- readtext("~/GitHub/RStudio/data murakami/Murakami.txt")
KorpusWonderland <- corpus(KonecSveta)
summary(KorpusWonderland)
as.character(KorpusWonderland)[2]
summary(KorpusWonderland, n = 1)
tokens(KorpusWonderland, remove_numbers = TRUE, remove_punct = TRUE, remove_symbols = TRUE, remove_url = TRUE, remove_separators = TRUE)
Tokeny <- tokens(KorpusWonderland, remove_numbers = TRUE, remove_punct = TRUE, remove_symbols = TRUE, remove_url = TRUE, remove_separators = TRUE)
MaleTokeny <- tokens_tolower(Tokeny, keep_acronyms = FALSE)
CisteTokeny <- tokens_select(MaleTokeny, pattern = stopwords(language = "en", source = "snowball", simplify = TRUE), selection = "remove")
print(CisteTokeny)
ManualniNiceni <- tokens_select(CisteTokeny, pattern = c("said", "like", "one", "say", "can", "go", "right"), selection = "remove")
MatrixWonderland <- tokens(ManualniNiceni) %>%
dfm()
MatrixWonderland[, 1:30]
MatrixWonderland <- dfm_wordstem(MatrixWonderland, language = quanteda_options("language_stemmer"))
topfeatures(MatrixWonderland, 80)
getStemLanguages()
library("quanteda")
library("readtext")
library("stopwords")
library("SnowballC")
library("wordcloud")
library("RColorBrewer")
library("quanteda.textplots")
library("quanteda.textstats")
library("ggplot2")
KonecSvěta <- readtext("~/GitHub/RStudio/data murakami/Murakami.txt")
KorpusWonderland <- corpus(KonecSveta)
summary(KorpusWonderland)
as.character(KorpusWonderland)[2]
summary(KorpusWonderland, n = 1)
tokens(KorpusWonderland, remove_numbers = TRUE, remove_punct = TRUE, remove_symbols = TRUE, remove_url = TRUE, remove_separators = TRUE)
Tokeny <- tokens(KorpusWonderland, remove_numbers = TRUE, remove_punct = TRUE, remove_symbols = TRUE, remove_url = TRUE, remove_separators = TRUE)
MaleTokeny <- tokens_tolower(Tokeny, keep_acronyms = FALSE)
CisteTokeny <- tokens_select(MaleTokeny, pattern = stopwords(language = "en", source = "snowball", simplify = TRUE), selection = "remove")
print(CisteTokeny)
ManualniNiceni <- tokens_select(CisteTokeny, pattern = c("said", "like", "one", "say", "can", "go", "right"), selection = "remove")
MatrixWonderland <- tokens(ManualniNiceni) %>%
dfm()
MatrixWonderland[, 1:30]
MatrixWonderland <- dfm_wordstem(MatrixWonderland, language = quanteda_options("english"))
MatrixWonderland <- dfm_wordstem(MatrixWonderland, language = ("english"))
topfeatures(MatrixWonderland, 80)
set.seed(100)
textplot_wordcloud(MatrixWonderland, min_count = 100, random_order = FALSE, rotation = 0.25, color = RColorBrewer::brewer.pal(9, "YlGnBu"))
dmf_weight(MatrixWonderland, scheme = "prop") %>%
textstat_simil(selection = c("world", "end"), method = "correlation", margin = "features") %>%
as.matrix() %>%
head(2)
dfm_weight(MatrixWonderland, scheme = "prop") %>%
textstat_simil(selection = c("world", "end"), method = "correlation", margin = "features") %>%
as.matrix() %>%
head(2)
dfm_weight(MatrixWonderland, scheme = "prop") %>%
textstat_simil(y = c("world", "end"), method = "correlation", margin = "features") %>%
as.matrix() %>%
head(2)
dfm_weight(MatrixWonderland, scheme = "prop") %>%
textstat_simil(selection = c("world", "end"), method = "correlation", margin = "features") %>%
as.matrix() %>%
head(2)
dfm_weight(MatrixWonderland, scheme = "prop") %>%
textstat_simil(y = c("world", "end"), method = "correlation", margin = "features") %>%
as.matrix() %>%
head(2)
dfm_weight(MatrixWonderland, scheme = "prop") %>%
textstat_simil(MatrixWonderland = c("world", "end"), method = "correlation", margin = "features") %>%
as.matrix() %>%
head(2)
dfm_weight(MatrixWonderland, scheme = "prop") %>%
textstat_simil(selection = c("world", "end"), method = "correlation", margin = "features") %>%
as.matrix() %>%
head(2)
dfm_weight(MatrixWonderland, scheme = "prop") %>%
textstat_simil(y = c("world", "end"), method = "correlation", margin = "features") %>%
as.matrix() %>%
head(2)
dfm_weight(MatrixWonderland, scheme = "prop") %>%
textstat_simil(MatrixWonderland, y = NULL, margin = c("world", "end"), method = "correlation", margin = "features") %>%
as.matrix() %>%
head(2)
dfm_weight(MatrixWonderland, scheme = "prop") %>%
textstat_simil(MatrixWonderland, MatrixWonderland[c("world", "end"), ], method = "correlation", margin = "features") %>%
as.matrix() %>%
head(2)
dfm_weight(MatrixWonderland, scheme = "prop") %>%
textstat_simil(MatrixWonderland, MatrixWonderland = c("world", "end"), method = "correlation", margin = "features") %>%
as.matrix() %>%
head(2)
dfm_weight(MatrixWonderland, scheme = "prop") %>%
textstat_simil(MatrixWonderland, MatrixWonderland = c("world", "end"), method = "correlation", margin = "features") %>%
as.matrix(tstat2) %>%
head(2)
dfm_weight(MatrixWonderland, scheme = "prop") %>%
textstat_simil(MatrixWonderland, MatrixWonderland = c("world", "end"), method = "correlation", margin = "features")
(ntoken(ManualniNiceni) / ntype(ManualniNiceni)) %>%
plot(type = "h", ylab = "Mean word frequency")
ntoken(ManualniNiceni) %>% head()
(ntoken(ManualniNiceni) / ntype(ManualniNiceni)) %>%
scale() %>%
plot(type = "h", ylab = "Scaled mean word frequency")
(ntoken(KorpusWonderland) / ntype(KorpusWonderland)) %>%
scale() %>%
plot(type = "h", ylab = "Scaled mean word frequency")
(ntoken(KorpusWonderland) / ntype(KorpusWonderland)) %>%
plot(type = "h", ylab = "Mean word frequency")
(ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>%
plot(type = "h", ylab = "Mean word frequency")
(ntoken(ManualniNiceni) / ntype(ManualniNiceni)) %>%
plot(type = "h", ylab = "Mean word frequency")
ntoken(MatrixWonderland) %>% head()
ntoken(KorpusWonderland) %>% head()
ntoken(MatrixWonderland) %>% head()
(ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>% head()
(ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>%
plot(type = "h", ylab = "Mean word frequency")
(ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>%
plot(type = "h", y = "Mean word frequency")
(ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>%
plot(type = "h", ylab = "Mean word frequency")
(ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>% head()
(ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>%
plot(type = "h", ylab = "Mean word frequency")
(ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>% head()
MeanWordFrequency <- ntoken(MatrixWonderland) %>% head()
(ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>%
plot(type = "h", ylab = "MeanWordFrequency")
(ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>%
plot(type = "h", ylab = MeanWordFrequency)
MeanWordFrequency <- ntoken(MatrixWonderland)
(ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>%
plot(type = "h", ylab = MeanWordFrequency)
MeanWordFrequency2 <- (ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>% head()
(ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>%
plot(type = "h", ylab = MeanWordFrequency2)
(ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>%
plot(type = "h", ylab = MeanWordFrequency2)
(ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>%
plot(type = "h", ylab = MeanWordFrequency2)
(ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>%
plot(type = "h", ylab = MeanWordFrequency2)
(ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>%
plot(type = "h", ylab = MeanWordFrequency2)
(ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>%
plot(type = "h", ylab = MeanWordFrequency2)
(ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>%
plot(type = "h", ylab = ntoken(MatrixWonderland))
firstChap <- as.matrix(MatrixWonderland)
numWords <- length(firstChap[firstChap > 0])
sum(MatrixWonderland[1,])/numWords
chapMeans <- Matrix::rowMeans(MatrixWonderland)
plot(chapMeans, type="h")
library("quanteda")
library("readtext")
library("stopwords")
library("SnowballC")
library("wordcloud")
library("RColorBrewer")
library("quanteda.textplots")
library("quanteda.textstats")
library("ggplot2")
KonecSvěta <- readtext("~/GitHub/RStudio/data murakami/Murakami.txt")
KorpusWonderland <- corpus(KonecSveta)
summary(KorpusWonderland)
MatrixWonderland <- tokens(KorpusWonderland) %>%
dfm()
MatrixWonderland[, 1:30]
topfeatures(MatrixWonderland, 80)
MeanWordFrequency <- ntoken(MatrixWonderland)
MeanWordFrequency2 <- (ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>% head()
(ntoken(MatrixWonderland) / ntype(MatrixWonderland)) %>%
plot(type = "h", ylab = ntoken(MatrixWonderland))
chapMeans <- Matrix::rowMeans(MatrixWonderland)
plot(chapMeans, type="h")
firstChap <- as.matrix(MatrixWonderland)
numWords <- length(firstChap[firstChap > 0])
sum(MatrixWonderland[1,])/numWords
FrequencyPlot <- textstat_frequency(MatrixWonderland, n = 100)
library("quanteda")
library("readtext")
library("stopwords")
library("SnowballC")
library("wordcloud")
library("RColorBrewer")
library("quanteda.textplots")
library("quanteda.textstats")
library("ggplot2")
KonecSvěta <- readtext("~/GitHub/RStudio/data murakami/Murakami.txt")
KorpusWonderland <- corpus(KonecSveta)
summary(KorpusWonderland)
as.character(KorpusWonderland)[2]
summary(KorpusWonderland, n = 1)
tokens(KorpusWonderland, remove_numbers = TRUE, remove_punct = TRUE, remove_symbols = TRUE, remove_url = TRUE, remove_separators = TRUE)
Tokeny <- tokens(KorpusWonderland, remove_numbers = TRUE, remove_punct = TRUE, remove_symbols = TRUE, remove_url = TRUE, remove_separators = TRUE)
MaleTokeny <- tokens_tolower(Tokeny, keep_acronyms = FALSE)
CisteTokeny <- tokens_select(MaleTokeny, pattern = stopwords(language = "en", source = "snowball", simplify = TRUE), selection = "remove")
print(CisteTokeny)
ManualniNiceni <- tokens_select(CisteTokeny, pattern = c("said", "like", "one", "say", "can", "go", "right"), selection = "remove")
MatrixWonderland <- tokens(ManualniNiceni) %>%
dfm()
MatrixWonderland[, 1:30]
MatrixWonderland <- dfm_wordstem(MatrixWonderland, language = ("english"))
topfeatures(MatrixWonderland, 80)
set.seed(100)
textplot_wordcloud(MatrixWonderland, min_count = 100, random_order = FALSE, rotation = 0.25, color = RColorBrewer::brewer.pal(9, "YlGnBu"))
FrequencyPlot <- textstat_frequency(MatrixWonderland, n = 100)
FrequencyPlot$feature <- with(FrequencyPlot, reorder(feature, -frequency))
ggplot(FrequencyPlot, aes(x = feature, y = frequency)) +
geom_point() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(FrequencyPlot, aes(x = feature, y = frequency)) +
geom_point() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
